def prioritize_exploits(modules, target_os):
    """
    Scores and prioritizes Metasploit modules based on rank and target OS match.
    Returns a sorted list of modules.
    """
    priority = {
        'excellent': 5,
        'great': 4,
        'good': 3,
        'normal': 2,
        'low': 1,
        'manual': 0
    }

    scored = []
    for mod in modules:
        rank = mod.get('rank', 'normal').lower()
        score = priority.get(rank, 2)

        # Boost score if target OS is mentioned in module name
        if target_os.lower() in mod.get('fullname', '').lower():
            score += 2

        scored.append((score, mod))

    # Sort by score descending
    scored.sort(reverse=True, key=lambda x: x[0])
    return [mod for score, mod in scored]

# Example usage:
# prioritized = prioritize_exploits(module_list, target_os="Windows 10")
# for mod in prioritized:
#     print(mod['fullname'], mod.get('rank', 'normal'))

